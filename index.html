<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>관제시스템 </title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<script type="text/javascript" src="js/jquery-3.5.1.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

	<link href="css/front.css" rel="stylesheet" type="text/css">
	<!--<link href="css/jquery-ui.css" rel="stylesheet" type="text/css">-->
	<link href="css/pagination.css" rel="stylesheet" type="text/css">

	<script src="js/front.js" type="text/javascript"></script>
	<script src="js/common.js" type="text/javascript"></script>
	<script src="js/index.js" type="text/javascript"></script>
	<script src="js/paginator.js" type="text/javascript"></script>
	<script>
  (function () {
    const token = sessionStorage.getItem('token');
    if (!token) {
      location.replace('login.html');
    }
  })();
</script>

</head>

<body>

	<div id="wrap">
		<header>
			<h1><img src="img/common/logo.svg"><span>자율주행차량 공공 통합 실시간 관제 시스템</span></h1>
			<div class="menu left">
				<input hidden id="vinMismatch" />
				<input hidden id="selectedKey" />
				<a id="vehicleStatus">
					<i><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path
								d="M15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7956 15 12 15C11.2044 15 10.4413 14.6839 9.87868 14.1213C9.31607 13.5587 9 12.7956 9 12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9C12.7956 9 13.5587 9.31607 14.1213 9.87868C14.6839 10.4413 15 11.2044 15 12Z"
								fill="black" />
							<path
								d="M21.8944 11.553C19.7364 7.236 15.9044 5 12.0004 5C8.09644 5 4.26444 7.236 2.10644 11.553C2.03708 11.6918 2.00098 11.8448 2.00098 12C2.00098 12.1552 2.03708 12.3082 2.10644 12.447C4.26444 16.764 8.09644 19 12.0004 19C15.9044 19 19.7364 16.764 21.8944 12.447C21.9638 12.3082 21.9999 12.1552 21.9999 12C21.9999 11.8448 21.9638 11.6918 21.8944 11.553ZM12.0004 17C9.03144 17 5.99844 15.38 4.13044 12C5.99844 8.62 9.03044 7 12.0004 7C14.9704 7 18.0024 8.62 19.8704 12C18.0024 15.38 14.9694 17 12.0004 17Z"
								fill="black" />
						</svg> </i>
					<span>차량 현황</span>
				</a>
				<a id="tripHistory">
					<i><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path
								d="M9 11.5C9.26522 11.5 9.51957 11.3946 9.70711 11.2071C9.89464 11.0196 10 10.7652 10 10.5C10 10.2348 9.89464 9.98043 9.70711 9.79289C9.51957 9.60536 9.26522 9.5 9 9.5C8.73478 9.5 8.48043 9.60536 8.29289 9.79289C8.10536 9.98043 8 10.2348 8 10.5C8 10.7652 8.10536 11.0196 8.29289 11.2071C8.48043 11.3946 8.73478 11.5 9 11.5ZM11 10.5C11 10.2348 11.1054 9.98043 11.2929 9.79289C11.4804 9.60536 11.7348 9.5 12 9.5H15C15.2652 9.5 15.5196 9.60536 15.7071 9.79289C15.8946 9.98043 16 10.2348 16 10.5C16 10.7652 15.8946 11.0196 15.7071 11.2071C15.5196 11.3946 15.2652 11.5 15 11.5H12C11.7348 11.5 11.4804 11.3946 11.2929 11.2071C11.1054 11.0196 11 10.7652 11 10.5ZM12 12.5C11.7348 12.5 11.4804 12.6054 11.2929 12.7929C11.1054 12.9804 11 13.2348 11 13.5C11 13.7652 11.1054 14.0196 11.2929 14.2071C11.4804 14.3946 11.7348 14.5 12 14.5H15C15.2652 14.5 15.5196 14.3946 15.7071 14.2071C15.8946 14.0196 16 13.7652 16 13.5C16 13.2348 15.8946 12.9804 15.7071 12.7929C15.5196 12.6054 15.2652 12.5 15 12.5H12ZM12 15.5C11.7348 15.5 11.4804 15.6054 11.2929 15.7929C11.1054 15.9804 11 16.2348 11 16.5C11 16.7652 11.1054 17.0196 11.2929 17.2071C11.4804 17.3946 11.7348 17.5 12 17.5H15C15.2652 17.5 15.5196 17.3946 15.7071 17.2071C15.8946 17.0196 16 16.7652 16 16.5C16 16.2348 15.8946 15.9804 15.7071 15.7929C15.5196 15.6054 15.2652 15.5 15 15.5H12ZM10 13.5C10 13.7652 9.89464 14.0196 9.70711 14.2071C9.51957 14.3946 9.26522 14.5 9 14.5C8.73478 14.5 8.48043 14.3946 8.29289 14.2071C8.10536 14.0196 8 13.7652 8 13.5C8 13.2348 8.10536 12.9804 8.29289 12.7929C8.48043 12.6054 8.73478 12.5 9 12.5C9.26522 12.5 9.51957 12.6054 9.70711 12.7929C9.89464 12.9804 10 13.2348 10 13.5ZM9 17.5C9.26522 17.5 9.51957 17.3946 9.70711 17.2071C9.89464 17.0196 10 16.7652 10 16.5C10 16.2348 9.89464 15.9804 9.70711 15.7929C9.51957 15.6054 9.26522 15.5 9 15.5C8.73478 15.5 8.48043 15.6054 8.29289 15.7929C8.10536 15.9804 8 16.2348 8 16.5C8 16.7652 8.10536 17.0196 8.29289 17.2071C8.48043 17.3946 8.73478 17.5 9 17.5Z"
								fill="black" />
							<path
								d="M9 2C8.73478 2 8.48043 2.10536 8.29289 2.29289C8.10536 2.48043 8 2.73478 8 3H6C5.46957 3 4.96086 3.21071 4.58579 3.58579C4.21071 3.96086 4 4.46957 4 5V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V5C20 4.46957 19.7893 3.96086 19.4142 3.58579C19.0391 3.21071 18.5304 3 18 3H16C16 2.73478 15.8946 2.48043 15.7071 2.29289C15.5196 2.10536 15.2652 2 15 2H9ZM16 5H18V20H6V5H8V6C8 6.26522 8.10536 6.51957 8.29289 6.70711C8.48043 6.89464 8.73478 7 9 7H15C15.2652 7 15.5196 6.89464 15.7071 6.70711C15.8946 6.51957 16 6.26522 16 6V5ZM10 5V4H14V5H10Z"
								fill="black" />
						</svg></i>
					<span>주행 기록</span>
				</a>
			</div>
			<div class="menu right">
				<a id="settings">
					<i><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path
								d="M12.0002 4C11.7349 4 11.4806 4.10536 11.293 4.29289C11.1055 4.48043 11.0002 4.73478 11.0002 5C11.0002 6.692 8.95415 7.54 7.75715 6.343C7.6649 6.24749 7.55456 6.17131 7.43256 6.1189C7.31055 6.06649 7.17933 6.0389 7.04655 6.03775C6.91377 6.03659 6.78209 6.0619 6.6592 6.11218C6.5363 6.16246 6.42465 6.23671 6.33076 6.3306C6.23686 6.4245 6.16261 6.53615 6.11233 6.65904C6.06205 6.78194 6.03675 6.91362 6.0379 7.0464C6.03905 7.17918 6.06664 7.3104 6.11905 7.4324C6.17146 7.55441 6.24764 7.66475 6.34315 7.757C7.54015 8.954 6.69315 11 5.00015 11C4.73493 11 4.48058 11.1054 4.29304 11.2929C4.10551 11.4804 4.00015 11.7348 4.00015 12C4.00015 12.2652 4.10551 12.5196 4.29304 12.7071C4.48058 12.8946 4.73493 13 5.00015 13C6.69215 13 7.54015 15.046 6.34315 16.243C6.16099 16.4316 6.0602 16.6842 6.06248 16.9464C6.06475 17.2086 6.16992 17.4594 6.35533 17.6448C6.54074 17.8302 6.79155 17.9354 7.05375 17.9377C7.31595 17.9399 7.56855 17.8392 7.75715 17.657C8.95415 16.46 11.0002 17.307 11.0002 19C11.0002 19.2652 11.1055 19.5196 11.293 19.7071C11.4806 19.8946 11.7349 20 12.0002 20C12.2654 20 12.5197 19.8946 12.7073 19.7071C12.8948 19.5196 13.0002 19.2652 13.0002 19C13.0002 17.308 15.0462 16.46 16.2432 17.657C16.3354 17.7525 16.4457 17.8287 16.5677 17.8811C16.6898 17.9335 16.821 17.9611 16.9537 17.9622C17.0865 17.9634 17.2182 17.9381 17.3411 17.8878C17.464 17.8375 17.5757 17.7633 17.6695 17.6694C17.7634 17.5755 17.8377 17.4638 17.888 17.341C17.9383 17.2181 17.9636 17.0864 17.9624 16.9536C17.9612 16.8208 17.9337 16.6896 17.8813 16.5676C17.8288 16.4456 17.7527 16.3352 17.6572 16.243C16.4601 15.046 17.3072 13 19.0002 13C19.2654 13 19.5197 12.8946 19.7073 12.7071C19.8948 12.5196 20.0002 12.2652 20.0002 12C20.0002 11.7348 19.8948 11.4804 19.7073 11.2929C19.5197 11.1054 19.2654 11 19.0002 11C17.3082 11 16.4601 8.954 17.6572 7.757C17.8393 7.5684 17.9401 7.31579 17.9378 7.0536C17.9355 6.7914 17.8304 6.54059 17.645 6.35518C17.4596 6.16977 17.2087 6.0646 16.9466 6.06232C16.6844 6.06005 16.4318 6.16084 16.2432 6.343C15.0462 7.54 13.0002 6.693 13.0002 5C13.0002 4.73478 12.8948 4.48043 12.7073 4.29289C12.5197 4.10536 12.2654 4 12.0002 4ZM9.00815 4.777C9.06345 4.02127 9.40269 3.31446 9.9577 2.79858C10.5127 2.28269 11.2424 1.99594 12.0002 1.99594C12.7579 1.99594 13.4876 2.28269 14.0426 2.79858C14.5976 3.31446 14.9368 4.02127 14.9922 4.777C15.566 4.28418 16.3048 4.02631 17.0606 4.05501C17.8164 4.08371 18.5336 4.39686 19.0683 4.93178C19.6031 5.46669 19.9161 6.18387 19.9446 6.93972C19.9732 7.69557 19.7151 8.43431 19.2222 9.008C19.9779 9.06317 20.6848 9.40229 21.2007 9.95722C21.7167 10.5122 22.0036 11.2418 22.0037 11.9995C22.0038 12.7573 21.7172 13.487 21.2014 14.0421C20.6856 14.5972 19.9789 14.9366 19.2232 14.992C19.716 15.5658 19.9738 16.3046 19.9451 17.0604C19.9164 17.8163 19.6033 18.5334 19.0684 19.0682C18.5335 19.603 17.8163 19.916 17.0604 19.9445C16.3046 19.973 15.5658 19.715 14.9922 19.222C14.9368 19.9777 14.5976 20.6845 14.0426 21.2004C13.4876 21.7163 12.7579 22.0031 12.0002 22.0031C11.2424 22.0031 10.5127 21.7163 9.9577 21.2004C9.40269 20.6845 9.06345 19.9777 9.00815 19.222C8.43446 19.715 7.69573 19.973 6.93988 19.9445C6.18402 19.916 5.46684 19.603 4.93193 19.0682C4.39702 18.5334 4.08386 17.8163 4.05516 17.0604C4.02646 16.3046 4.28433 15.5658 4.77715 14.992C4.02142 14.9367 3.31462 14.5975 2.79873 14.0424C2.28284 13.4874 1.99609 12.7577 1.99609 12C1.99609 11.2422 2.28284 10.5126 2.79873 9.95755C3.31462 9.40253 4.02142 9.0633 4.77715 9.008C4.28283 8.43441 4.0237 7.6951 4.05174 6.93842C4.07979 6.18173 4.39294 5.46364 4.92836 4.92821C5.46379 4.39279 6.18188 4.07964 6.93857 4.05159C7.69526 4.02355 8.43456 4.28268 9.00815 4.777Z"
								fill="black" />
							<path
								d="M11.9997 10C11.4692 10 10.9605 10.2107 10.5855 10.5858C10.2104 10.9609 9.99968 11.4696 9.99968 12C9.99968 12.5304 10.2104 13.0391 10.5855 13.4142C10.9605 13.7893 11.4692 14 11.9997 14C12.5301 14 13.0388 13.7893 13.4139 13.4142C13.789 13.0391 13.9997 12.5304 13.9997 12C13.9997 11.4696 13.789 10.9609 13.4139 10.5858C13.0388 10.2107 12.5301 10 11.9997 10ZM9.17168 9.172C9.54066 8.78996 9.98204 8.48523 10.4701 8.27559C10.9581 8.06596 11.483 7.95561 12.0141 7.95099C12.5452 7.94638 13.0719 8.04759 13.5635 8.24871C14.0551 8.44983 14.5017 8.74685 14.8773 9.12242C15.2528 9.49799 15.5498 9.94459 15.751 10.4362C15.9521 10.9278 16.0533 11.4545 16.0487 11.9856C16.0441 12.5167 15.9337 13.0416 15.7241 13.5296C15.5144 14.0176 15.2097 14.459 14.8277 14.828C14.0733 15.5566 13.0629 15.9598 12.0141 15.9507C10.9653 15.9416 9.96203 15.5209 9.2204 14.7793C8.47877 14.0376 8.05809 13.0344 8.04898 11.9856C8.03987 10.9368 8.44304 9.92641 9.17168 9.172Z"
								fill="black" />
						</svg></i>
					<span>설정</span>
				</a>
			</div>
		</header>
		<div id="container">
			<div class="content">
				<div class="map-area">
					<div id="map"></div>
				</div>
				<!-- 차량현황 -->
				<div class="side" id="vehicleStatusContainer" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="status">
							<dl>
								<dt>등록차량</dt>
								<dd><strong id="registeredVehicle">0</strong>대</dd>
							</dl>
							<dl>
								<dt>사용중</dt>
								<dd><strong id="beingUsed">0</strong>대</dd>
							</dl>
							<dl>
								<dt>사용종료</dt>
								<dd><strong id="useEnd">0</strong>대</dd>
							</dl>
						</div>
						<div class="search">
							<input type="text" placeholder="차량번호 검색" class="inp" id="search_input">
							<button class="btn-srch" id="searchBtn"><span class="hidden">검색</span></button>
						</div>
						<div class="table">
							<table>
								<colgroup>
									<col style="width:33%">
									<col style="width:33%">
									<col style="width:33%">
								</colgroup>
								<thead>
									<tr>
										<th>차량명</th>
										<th>주행시작</th>
										<!--<th>상태 <img src="img/common/arrow_down.svg"></th>-->
										<th>
											<select id="stateSelect" class="select">
												<option value="">상태 선택</option>
												<option value="1">수동주행</option>
												<option value="2">반자율주행(Lv.2)</option>
												<option value="3">자율주행</option>
												<option value="4">협력형자율주행</option>

										</th>

										</select>
									</tr>
								</thead>
								<tbody id="listB">
								</tbody>

							</table>
							<div class="paging">
								<div id="pagerB" class="pager"></div>
							</div>
						</div>
					</div>
					<button class="btn-toggle"><span class="hidden">토글</span></button>
				</div>

				<div class="side" id="vehicleStatusDetail" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="left" id="btn-back-status">
								<button class="btn-back"><span class="hidden">뒤로</span></button>
							</div>
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="car-info">
							<div class="my-number"><strong id="plateNum"></strong> <button class="btn-refresh"></button>
							</div>
							<div class="stat">
								<div class="box">
									<dl>
										<dt>속도</dt>
										<dd id="speed">0</dd>
									</dl>
									<dl>
										<dt>RPM</dt>
										<dd id="rpm">0</dd>
									</dl>
									<dl>
										<dt>주행거리</dt>
										<dd id="distance">0</dd>
									</dl>
								</div>
								<div class="box">
									<dl>
										<dt>Lidar</dt>
										<dd id="lidarStatus">알수없음</dd>
									</dl>
									<dl>
										<dt>Camera</dt>
										<dd id="cameraStatus">알수없음</dd>
									</dl>
									<dl>
										<dt>Radar</dt>
										<dd id="radarStatus">알수없음</dd>
									</dl>
								</div>
								<div class="box last">
									<div class="tit">DTC 코드</div>
									<div class="txt">
										[P0455] 파워트레인<br>[B100352] 차체<br>[P0001] 엔진<br>[P0002] 항목명입니다<br>[P0002] 항목명입니다
									</div>
								</div>
							</div>
							<div class="more">
								<button class="btn-tog">주행정보 <img src="img/common/ico_btn_toggle.svg"></button>
							</div>
						</div>
						<div class="gostop off">
							<div class="icons">
								<img src="img/common/marker_start.svg">
								<i></i>
								<img src="img/common/marker_arrive.svg">
							</div>
							<div class="vals">
								<dl>
									<dt>출발</dt>
									<dd>2025/12/22 15:00</dd>
								</dl>
								<dl>
									<dt>도착예정</dt>
								</dl>
							</div>
						</div>
						<div class="title">이벤트 발생 이력</div>
						<div class="table">
							<table>
								<colgroup>
									<col style="width:40%">
									<col style="width:60%">

								</colgroup>
								<thead>
									<tr>
										<th>발생일시</th>
										<th>이벤트</th>

									</tr>
								</thead>
								<tbody id="listStatusEvent">
								</tbody>
							</table>
							<div class="paging">
								<div id="pagerStatusEvent" class="pager"></div>
							</div>
						</div>

					</div>
					<button class="btn-toggle"><span class="hidden">토글</span></button>
				</div>

				<!-- 주행기록 -->
				<div class="side" id="tripHstrContainer" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="date-box">
							<input type="text" class="inp calendar" value="2026/01/01" id="startDate">
							<span>~</span>
							<input type="text" class="inp calendar" value="2026/02/25" id="endDate">
						</div>
						<div class="search">
							<input type="text" placeholder="차량번호 검색" class="inp" id="search_input_trip">
							<button class="btn-srch" id="searchTrip"><span class="hidden">검색</span></button>
						</div>
						<div class="table">
							<table>
								<colgroup>
									<col style="width:33%">
									<col style="width:33%">
									<col style="width:33%">
								</colgroup>
								<thead>
									<tr>
										<th>차량명</th>
										<th>주행시작</th>
										<th>주행종료</th>
									</tr>
								</thead>
								<tbody id="listC">
								</tbody>
							</table>
							<div class="paging">
								<div id="pagerC" class="pager"></div>
							</div>
						</div>

					</div>
					<button class="btn-toggle"><span class="hidden">토글</span></button>
				</div>

				<div class="side" id="tripHstrDetail" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="left" id="btn-back-hstr">
								<button class="btn-back"><span class="hidden">뒤로</span></button>
							</div>
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="car-info">
							<div class="my-number"><strong id="tripSn">777마7777</strong> <!--<button
									class="btn-refresh"></button>--></div>
							<div class="stat" style="display: none;">
								<div class="box">
									<dl>
										<dt>속도</dt>
										<dd>30km/h</dd>
									</dl>
									<dl>
										<dt>RPM</dt>
										<dd>2,500</dd>
									</dl>
									<dl>
										<dt>주행거리</dt>
										<dd>50km</dd>
									</dl>
								</div>
								<div class="box">
									<dl>
										<dt>Lidar</dt>
										<dd>정상</dd>
									</dl>
									<dl>
										<dt>Camera</dt>
										<dd>이상</dd>
									</dl>
									<dl>
										<dt>Radar</dt>
										<dd>정상</dd>
									</dl>
								</div>
								<div class="box last">
									<div class="tit">DTC 코드</div>
									<div class="txt">
										[P0455] 파워트레인<br>[B100352] 차체<br>[P0001] 엔진<br>[P0002] 항목명입니다<br>[P0002] 항목명입니다
									</div>
								</div>
							</div>
							<div class="stat">
								<div class="box">
									<dl>
										<dt>주행거리</dt>
										<dd id="tripDistance">50km</dd>
									</dl>
								</div>
							</div>
							<!-- <div class="more">
								<button class="btn-tog active">주행정보 <img src="img/common/ico_btn_toggle.svg"></button>
							</div> -->
						</div>
						<div class="gostop ">
							<div class="icons">
								<img src="img/common/marker_start.svg">
								<i></i>
								<img src="img/common/marker_arrive.svg">
							</div>
							<div class="vals">
								<dl>
									<dt>출발</dt>
									<dd id="tripStart">2025/12/22 15:00</dd>
								</dl>
								<dl>
									<dt>도착</dt>
									<dd id="tripEnd">2025/12/22 15:00</dd>
								</dl>
							</div>
						</div>
						<div class="title">이벤트 발생 이력</div>
						<div class="table">
							<table>
								<colgroup>
									<col style="width:40%">
									<col style="width:60%">

								</colgroup>
								<thead>
									<tr>
										<th>발생일시</th>
										<th>이벤트</th>

									</tr>
								</thead>
								<tbody id="listTripEvent">

								</tbody>
							</table>
							<div class="paging">
								<div id="pagerTripEvent" class="pager"></div>
							</div>
						</div>

					</div>
					<button class="btn-toggle"><span class="hidden">토글</span></button>
				</div>

				<!-- 차량·단말 관리 -->
				<div class="side right" id="vehicleDeviceMngContainer" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="tabs">
								<a class="active">차량·단말 관리</a>
								<a id="accountMngBtn">계정 관리</a>
							</div>
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="cont" id="Cont1">
							<div class="table-title">
								<h3>미장착 단말 관리</h3>
								<div class="hits">
									<div class="num">등록 가능 단말 <strong id="availableDeviceNum">6</strong> 대</div>
								</div>
							</div>
							<div class="table-title">
								<div class="search">
									<input id="search_input_device" type="text" placeholder="단말번호로 검색" class="inp">
									<button id="searchDeviceBtn" class="btn-srch"><span
											class="hidden">검색</span></button>
								</div>
								<select id="devicePageSizeSelect" class="select">
									<option value="5">5건씩 보기</option>
									<option value="10">10건씩 보기</option>
									<option value="20">20건씩 보기</option>
									<option value="50">50건씩 보기</option>
								</select>
							</div>
							<div class="table">
								<table>
									<colgroup>
										<col style="width:50%">
										<col style="width:50%">
									</colgroup>
									<thead>
										<tr>
											<th>단말정보</th>
											<th>차량 장착</th>
										</tr>
									</thead>
									<tbody id="deviceList">


									</tbody>
								</table>
								<div class="paging">
									<div id="pagerDeviceList" class="pager"></div>
								</div>
							</div>

							<div class="table-title">
								<h3>차량 관리</h3>
								<div class="hits">
									<div class="num">사용중 <strong id="beingUsedNum">6</strong> 대</div>
									<div class="num">사용종료 <strong id="useEndNum">6</strong> 대</div>
								</div>
							</div>
							<div class="table-title">
								<div class="search">
									<input id="search_input_vehicle" type="text" placeholder="차량명, 단말번호로 검색"
										class="inp">
									<button id="searchVehicleBtn" class="btn-srch"><span
											class="hidden">검색</span></button>
								</div>
								<div class="right">
									<button id="deleteVehicle" class="btn-line">삭제 <img
											src="img/common/alert_minus.svg"></button>
									<select id="vehiclePageSizeSelect" class="select">

										<option value="5">5건씩 보기</option>
										<option value="10">10건씩 보기</option>
										<option value="20">20건씩 보기</option>
										<option value="50">50건씩 보기</option>
									</select>
								</div>
							</div>
							<div class="table">
								<table>
									<thead>
										<tr>
											<th></th>
											<th>차량명</th>
											<th>단말정보</th>
											<th>PCL</th>
											<th>사용구분</th>
											<th>차량 장착 해제</th>
										</tr>
									</thead>
									<tbody id="vehicleList">
										<!--
										<tr>
											<td>
												<label><input type="checkbox" class="checkbox">
													<div><em></em></div>
												</label>
											</td>
											<td>123가4567</td>
											<td>
												von-U52
												ABC000001
											</td>
											<td>J1939</td>
											<td>사용중</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
										<tr>
											<td>
												<label><input type="checkbox" class="checkbox">
													<div><em></em></div>
												</label>
											</td>
											<td>123가4567</td>
											<td>
												von-U52
												ABC000001
											</td>
											<td>J1939</td>
											<td>사용중</td>
											<td><button class="btn">단말 연동 해제</button></td>
										</tr>-->
									</tbody>
								</table>
								<div class="paging">
									<div id="pagerVehicleList" class="pager"></div>
								</div>
							</div>

						</div>
					</div>

				</div>
				<!-- 계정관리 -->
				<div class="side right" id="accountMngContainer" style="display: none;">
					<div class="area">
						<div class="head">
							<div class="tabs">
								<a id="vehicleDeviceMngBtn">차량·단말 관리</a>
								<a class="active">계정 관리</a>
							</div>
							<div class="right">
								<button class="btn-close"><span class="hidden">닫기</span></button>
							</div>
						</div>
						<div class="cont" id="Cont1" style="display: none;">
							<div class="table-title">
								<h3>미장착 단말 관리</h3>
								<div class="hits">
									<div class="num">등록 가능 단말 <strong>6</strong> 대</div>
								</div>
							</div>
							<div class="table-title">
								<div class="search">
									<input type="text" placeholder="단말번호로 검색" class="inp">
									<button class="btn-srch"><span class="hidden">검색</span></button>
								</div>
								<select class="select">
									<option>5건씩 보기</option>
								</select>
							</div>
							<div class="table">
								<table>
									<colgroup>
										<col style="width:50%">
										<col style="width:50%">
									</colgroup>
									<thead>
										<tr>
											<th>단말정보</th>
											<th>차량 장착</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>
												von-U52
												ABC000001
											</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
										<tr>
											<td>
												von-U52
												ABC000001
											</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
										<tr>
											<td>
												von-U52
												ABC000001
											</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
										<tr>
											<td>
												von-U52
												ABC000001
											</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
									</tbody>
								</table>
							</div>


							<div class="table-title">
								<h3>차량 관리</h3>
								<div class="hits">
									<div class="num">사용중 <strong>6</strong> 대</div>
									<div class="num">사용종료 <strong>6</strong> 대</div>
								</div>
							</div>
							<div class="table-title">
								<div class="search">
									<input type="text" placeholder="차량명, 단말번호로 검색" class="inp">
									<button class="btn-srch"><span class="hidden">검색</span></button>
								</div>
								<div class="right">
									<button class="btn-line">삭제 <img src="img/common/alert_minus.svg"></button>
									<select class="select">
										<option>5건씩 보기</option>
									</select>
								</div>
							</div>
							<div class="table">
								<table>
									<thead>
										<tr>
											<th></th>
											<th>차량명</th>
											<th>단말정보</th>
											<th>PCL</th>
											<th>사용구분</th>
											<th>차량 장착 해제</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td>
												<label><input type="checkbox" class="checkbox">
													<div><em></em></div>
												</label>
											</td>
											<td>123가4567</td>
											<td>
												von-U52
												ABC000001
											</td>
											<td>J1939</td>
											<td>사용중</td>
											<td><button class="btn">차량·단말기 연동</button></td>
										</tr>
										<tr>
											<td>
												<label><input type="checkbox" class="checkbox">
													<div><em></em></div>
												</label>
											</td>
											<td>123가4567</td>
											<td>
												von-U52
												ABC000001
											</td>
											<td>J1939</td>
											<td>사용중</td>
											<td><button class="btn">단말 연동 해제</button></td>
										</tr>
									</tbody>
								</table>
							</div>


						</div>
						<div class="cont" id="Cont2">
							<div class="table-title">
								<h3>계정 정보</h3>
							</div>
							<div class="table1">
								<table>
									<colgroup>
										<col style="width:20%">
										<col style="width:80%">
									</colgroup>
									<tbody>
										<tr>
											<th>계정명</th>
											<td>
												<dl>
													<dt id="accountUserName">자스텍앰</dt>
													<dd><a id="userNameChange" class="btn btn1">변경</a></dd>
												</dl>
											</td>
										</tr>
										<tr>
											<th>아이디</th>
											<td>
												<dl>
													<dt id="accountId">test123@jastecm.com</dt>
													<dd><a id="idChange" class="btn btn1">변경</a></dd>
												</dl>
											</td>
										</tr>
										<tr>
											<th>비밀번호</th>
											<td>
												<a id="pwChange" class="btn btn1">변경</a>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
							<div class="btn-area">
								<a id="logoutBtn" class="btn">로그아웃 <img src="img/common/ico_logout.svg"></a>
							</div>
						</div>
					</div>

				</div>
				<div class="alert-area">
					<!--<div class="msg white" id="deviceAttach">단말기 탈부착 감지. 장착 차량 확인 필요</div>
					<div class="msg red">단말기 탈부착 감지. 장착 차량 확인 필요</div>-->
				</div>
				<!--
				<div class="marker gray" style="left: 40%; top:40%">
					<div class="number">
						<i class="alert"></i>
						<span>123가4567</span>
					</div>
					<div class="box">
						<div class="name"><i class="bg-red"></i>LiDAR</div>
						<div class="name"><i class="bg-green"></i>RADAR</div>
						<div class="name"><i class="bg-green"></i>Camera</div>
					</div>
				</div>

				<div class="marker gray" style="left: 70%; top:70%">
					<div class="number">
						<i class="alert"></i>
						<span>123가4567</span>
					</div>
					<div class="box">
						<div class="name"><i class="bg-red"></i>LiDAR</div>
						<div class="name"><i class="bg-green"></i>RADAR</div>
						<div class="name"><i class="bg-green"></i>Camera</div>
					</div>
				</div>
				<div class="marker green" style="left: 50%; top:50%">
					<div class="number">
						<i class="alert"></i>
						<span>123가4567</span>
					</div>
					<div class="box">
						<div class="name"><i class="bg-red"></i>LiDAR</div>
						<div class="name"><i class="bg-green"></i>RADAR</div>
						<div class="name"><i class="bg-green"></i>Camera</div>
					</div>
				</div>


				<div class="map-marker start" style="left: 30%; top:40%;;"><img src="img/common/marker_start.svg"></div>
				<div class="map-marker arrive" style="left: 40%; top:55%;;"><img src="img/common/marker_arrive.svg">
				</div>-->

			</div>
		</div>
	</div>
	<!-- 모달 모음 -->
	<div class="popup-wrap" id="Modal1">
		<div class="bg-popup"></div>
		<div class="popup-box">
			<div class="popup-cont">
				<div class="popup" style="max-width:68rem">
					<div class="popup-head">
						<h3>장착 차량 확인</h3>
						<button class="btn-close" onclick="javascript:popupClose('Modal1');"><span
								class="hidden">닫기</span></button>
					</div>
					<div class="popup-body">
						<div class="desc1">단말기 탈부착이 감지되었습니다. <br>단말기와 연동된 차량 정보가 맞는지 확인해주시기 바랍니다.</div>
						<div class="table1">
							<table>
								<colgroup>
									<col style="width:25%">
									<col style="width:75%">
								</colgroup>
								<tbody>
									<tr>
										<th>단말기 일련번호</th>
										<td id="deviceSn">ABA131313</td>
									</tr>
									<tr>
										<th>차대번호</th>
										<td id="vehiclePlateNum">ABA131313</td>
									</tr>
									<tr>
										<th>차량명</th>
										<td id="vehicleName">TEST</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="desc2">장착 차량이 변경된 경우, 기존 차량과의 연동을 해제하신 후,<br>
							새로 차량·단말기 연동을 진행해주시기 바랍니다.<br>
							<span class="red">※ 차량정보가 다를 경우, 데이터가 올바르게 수집되지 않을 수 있습니다.</span>
						</div>
						<div class="btn-area">
							<a class="btn btn1" id="vinMismatchFix">연동 차량 유지</a>
							<a class="btn btn2" id="keepAttached">신규차량 연동</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>



	<div class="popup-wrap" id="Modal2">
		<div class="bg-popup"></div>
		<div class="popup-box">
			<div class="popup-cont">
				<div class="popup" style="max-width:70rem">
					<div class="popup-head">
						<h3>차량·단말기 연동</h3>
						<button class="btn-close-popup" onclick="javascript:popupClose('Modal2');"><span
								class="hidden">닫기</span></button>
					</div>
					<div class="popup-body">
						<div class="title">차량 기본정보</div>
						<div class="table1">
							<table>
								<colgroup>
									<col style="width:25%">
									<col style="width:75%">
								</colgroup>
								<tbody>
									<tr>
										<th>단말기 일련번호</th>
										<td id="deviceSnInput"></td>
									</tr>
									<tr>
										<th>차량번호</th>
										<td><input id="vehiclePlateNumInput" type="text" class="inp"
												placeholder="차량번호, 별칭 등을 입력하세요" style="width:60%"></td>
									</tr>
									<tr>
										<th>PCL 종류</th>
										<td>
											<select id="pclInput" class="select" style="width:60%">
												<option value="">선택</option>
												<option value="J1939">J1939</option>
												<option value="OBD2">OBD2</option>
											</select>
										</td>
									</tr>

									<tr>
										<th>v2x연동키(trmnlId)</th>
										<td><input id="v2xKeyInput" type="text" class="inp" placeholder="v2x연동키를 입력하세요"
												style="width:60%"></td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="guide-box">
							<div class="title">단말 장착 방법</div>
							<div class="text"><span>시동 OFF</span>인 상태로, 차량에 그림과 같이 <span>단말기를 장착</span>해주세요.<br>
								장착이 완료되면 단말기 램프 3색이 모두 켜집니다.
							</div>
							<div class="img-box">
								<div class="img"><img src="img/common/tmp.jpg"></div>
								<div class="right">
									<div>
										<img src="img/common/ico_alert.svg">
										<strong>OBD단자 위치는,</strong><br>
										대부분의 차량은 운전석 하단에 위치하고 있지만,
										일부 차량은 콘솔박스 안쪽에 위치하고 있습니다.
									</div>
									<div>
										<img src="img/common/ico_alert.svg">
										<strong>OBD 단말기 장착 후 퓨즈 박스가 닫히지 않는다면,</strong><br>
										OBD단자를 차량 안쪽으로 밀어 이동시킨 후,
										단말기를 장착해보세요.<br>
										차량의 OBD단자는 탈부착이 가능합니다.
									</div>
								</div>
							</div>
						</div>
						<div class="btn-area">
							<a onclick="javascript:popupClose('Modal2');" class="btn btn1">취소</a>
							<a id="vehicleReg" class="btn btn2">등록</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="popup-wrap" id="ModalUserName">
		<div class="bg-popup"></div>
		<div class="popup-box">
			<div class="popup-cont">
				<div class="popup" style="max-width:70rem">
					<div class="popup-head">
						<h3>계종명 변경</h3>
						<button class="btn-close-popup" onclick="javascript:popupClose('ModalUserName')"><span
								class="hidden">닫기</span></button>
					</div>
					<div class="popup-body">
						<div class="table1">
							<table>
								<colgroup>
									<col style="width:25%">
									<col style="width:75%">
								</colgroup>
								<tbody>
									<tr>
										<th>계종명</th>
										<td><input type="text" class="inp" placeholder="" style="width:70%"
												id="userNameInput"></td>
									</tr>

								</tbody>
							</table>
						</div>

						<div class="btn-area">
							<a id="nameChangeClose" class="btn btn1">취소</a>
							<a class="btn btn2" id="userNameChangeBtn">변경하기</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="popup-wrap" id="ModalId">
		<div class="bg-popup"></div>
		<div class="popup-box">
			<div class="popup-cont">
				<div class="popup" style="max-width:70rem">
					<div class="popup-head">
						<h3>아이디 변경</h3>
						<button class="btn-close-popup" onclick="javascript:popupClose('ModalId');"><span
								class="hidden">닫기</span></button>
					</div>
					<div class="popup-body">
						<div class="table1">
							<table>
								<colgroup>
									<col style="width:25%">
									<col style="width:75%">
								</colgroup>
								<tbody>
									<tr>
										<th>아이디</th>
										<td><input type="text" class="inp" placeholder="" style="width:70%"
												id="idInput"></td>
									</tr>

								</tbody>
							</table>
						</div>

						<div class="btn-area">
							<a onclick="javascript:popupClose('ModalId');" class="btn btn1">취소</a>
							<a class="btn btn2" id="idChangeBtn">변경하기</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="popup-wrap" id="ModalPw">
		<div class="bg-popup"></div>
		<div class="popup-box">
			<div class="popup-cont">
				<div class="popup" style="max-width:70rem">
					<div class="popup-head">
						<h3>비밀번호 변경</h3>
						<button class="btn-close-popup" onclick="javascript:popupClose('ModalPw');"><span
								class="hidden">닫기</span></button>
					</div>
					<div class="popup-body">
						<div class="table1">
							<table>
								<colgroup>
									<col style="width:25%">
									<col style="width:75%">
								</colgroup>
								<tbody>
									<tr>
										<th>현재 비밀번호</th>
										<td><input type="password" class="inp" placeholder="" style="width:70%"
												id="pwOldInput"></td>
									</tr>
									<tr>
										<th>새로운 비밀번호</th>
										<td>
											<input type="password" class="inp" placeholder="" style="width:70%"
												id="pwNewInput">

											<div class="pw-check" id="pwStrengthCheck" style="display: none;">
												<div class="bar"><em
														style="width:33.3333%;background-color: #E51626;"></em></div>
												<p><span style="color:#E51626">4자리 이상 입력해주세요</span></p>
											</div>
										</td>
									</tr>
									<tr>
										<th>비밀번호 확인</th>
										<td>
											<input id="pwNewInputCheck" type="password" class="inp" placeholder=""
												style="width:70%">

											<div class="pw-check" id="pw-match-check" style="display: none;">
												<p><span style="color:#E51626">비밀번호가 일치하지 않습니다.</span></p>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class="desc2">위와 같이 비밀번호를 변경하시겠습니까?</div>
						<div class="btn-area">
							<a onclick="javascript:popupClose('ModalPw');" class="btn btn1">취소</a>
							<a class="btn btn2" id="pwChangeBtn">변경하기</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		$(function () {
			let accountInfo = {};
			const token = sessionStorage.getItem('token');
			if (!token) {
				location.href = 'login.html';	
			}
			console.log("vehicle_data", vehicle_data);
			// 지도 초기화
			initMapA('map');


			$("#searchBtn").on("click", function () {
				applySearchVehicle();
			});
			$("#search_input").on("keyup", function (key) {
				if (key.keyCode == 13) {
					$('#searchBtn').trigger('click');
				}
			});

			$("#searchTrip").on("click", function () {
				applySearchTrip();
			});
			$("#search_input_trip").on("keyup", function (key) {
				if (key.keyCode == 13) {
					$('#searchTrip').trigger('click');
				}
			});
			//1234
			$("#searchDeviceBtn").on("click", function () {
				applySearchDevice();
			});
			$("#search_input_device").on("keyup", function (key) {
				if (key.keyCode == 13) {
					$('#searchDeviceBtn').trigger('click');
				}
			});
			//---
			$("#searchVehicleBtn").on("click", function () {
				applySearchVehicleMng();
			});
			$("#search_input_vehicle").on("keyup", function (key) {
				if (key.keyCode == 13) {
					$('#searchVehicleBtn').trigger('click');
				}
			});
			//
			$("#startDate").on("change", function () {
				console.log("startDate:", $(this).val(), " endDate:", $("#endDate").val());
			});
			$("#endDate").on("change", function () {
				const startDate = get_timestamp($("#startDate").val());
				const endDate = get_timestamp($(this).val());
				if (endDate > startDate) {
					const key = sessionStorage.getItem('token')
					trip_history_data = get_trip_history_data(key, startDate, endDate);
					if (trip_history_data['result']) {
						renderVehiclesC(startDate, endDate);

					}
				} else {
					alert('끝날짜는 시작날짜 이상이어야 합니다')
				}


			});

			$(".btn-close").on("click", function () {
				$(".side").hide();
			});

			$("#btnToggleStatus").on("click", function () {
				$(".side").hide();
			});
			$("#btnToggleTrip").on("click", function () {
				$(".side").hide();
			});

			$("#vehicleStatus").on("click", function () {
				$(this).addClass("active");
				$("#tripHistory").removeClass("active");
				$("#settings").removeClass("active");
				$("#tripHstrContainer").hide();
				$("#tripHstrDetail").hide();
				$("#vehicleStatusDetail").hide();
				$("#vehicleDeviceMngContainer").hide();
				$("#accountMngContainer").hide();
				//$(".alert-area").hide();
				$("#vehicleStatusContainer").show();
				vehicleStatusView();
				renderVehiclesB();
			});
			$("#tripHistory").on("click", function () {
				$(this).addClass("active");
				$("#vehicleStatus").removeClass("active");
				$("#settings").removeClass("active");
				$("#vehicleStatusContainer").hide();
				$("#vehicleStatusDetail").hide();
				$("#tripHstrDetail").hide();
				$("#vehicleDeviceMngContainer").hide();
				$("#accountMngContainer").hide();
				$("#tripHstrContainer").show();
				$(".alert-area").show();
				tripHistoryView();
				renderVehiclesC();
			});
			$("#btn-back-status").on("click", function () {
				$("#vehicleStatusDetail").hide();
				$("#vehicleStatusContainer").show();

			});
			$("#btn-back-hstr").on("click", function () {
				$("#tripHstrDetail").hide();
				$("#tripHstrContainer").show();

			});

			const $alertArea = $('.alert-area');
			$alertArea.empty()
			vehicle_data['data']['items'].forEach(item => {
				if (item.vinMismatch === '1') {
					const itemObj = jsonToBase64(item);
					const $item = $(`<div class="msg white" data-item="${itemObj}">단말기 탈부착 감지. 장착 차량 확인 필요</div>`)
					$alertArea.append($item)
				}

			})
			$(".alert-area .msg").on("mouseover", function () {
				$(this).addClass("red");
			});
			$(".alert-area .msg").on("mouseout", function () {
				$(this).removeClass("red");
			});
			$(".alert-area .msg").on("click", function () {
				$(".side").hide();
				const itemObj = $(this).data("item");
				$("#vinMismatch").val(itemObj)
				popupOpen('Modal1');
			});
			$("#keepAttached").on("click", function () {
				popupClose('Modal1');
				$(".alert-area").hide();
				$("#vehicleDeviceMngContainer").show();
				renderDeviceList()
				renderVehicleList()

			});
			$("#settings").on("click", function () {
				$(this).addClass("active");
				$("#vehicleStatus").removeClass("active");
				$("#tripHistory").removeClass("active");
				$("#vehicleStatusContainer").hide();
				$("#vehicleStatusDetail").hide();
				$("#tripHstrContainer").hide();
				$("#tripHstrDetail").hide();
				$(".alert-area").hide();
				$("#vehicleDeviceMngContainer").show();
				renderDeviceList()
				renderVehicleList()
			});
			$("#vehicleDeviceMngBtn").on("click", function () {
				$("#accountMngContainer").hide();
				$("#vehicleDeviceMngContainer").show();
				// renderDeviceList()
				// renderVehicleList()

			});
			$("#accountMngBtn").on("click", function () {
				$("#vehicleDeviceMngContainer").hide();
				$("#accountMngContainer").show();
				accountInfo = get_me(token)
				if (accountInfo['result']) {
					$("#accountMngContainer #accountUserName").text(accountInfo['data']['accountName']);
					$("#accountMngContainer #accountId").text(accountInfo['data']['accountId']);
					$("#userNameInput").val(accountInfo['data']['accountName'])
					$("#idInput").val(accountInfo['data']['accountId'])
				}
			});


			$("#userNameChange").on("click", function () {
				popupOpen('ModalUserName');
			});
			$("#idChange").on("click", function () {
				popupOpen('ModalId');
			});
			$("#pwChange").on("click", function () {
				popupOpen('ModalPw');
			});
			$("#logoutBtn").on("click", function () {
				sessionStorage.removeItem('token')
			    sessionStorage.removeItem('member')
				localStorage.removeItem('auto_login');
			
				location.href = "./login.html"
			});
			$("#deleteVehicle").on("click", function () {

				const key = $("#selectedKey").val()
				if (key) {
					const vehicleDel = vehicleDelete(token, key)
					if (vehicleDel['result']) {
						alert('차량 삭제 성공했습니다')
						renderDeviceList()
						renderVehicleList()
					}
					else
						alert('차량 삭제 실패했습니다')

				} else {
					alert("삭제할 차량을 선택해주세요")
				}


			});

			$("#stateSelect").on("change", function () {
				const val = $(this).val()
				renderVehiclesB()

			});




		});

		function popupOpen(id) {
			$('#' + id).fadeIn(300);
			$('body').addClass('popup-on');
			if (id === "Modal1" && $('#vinMismatch').val()) {
				const itemObj = base64ToJsonObj($('#vinMismatch').val())
				$('#Modal1 #deviceSn').text(itemObj.deviceSn)
				$('#Modal1 #vehiclePlateNum').text(itemObj.plateNum)
				$('#Modal1 #vehicleName').text(itemObj.plateNum)
				$('#Modal1 #vinMismatchFix').on('click', function () {
					const vinFix = vinMismatchFix(itemObj.vehicleKey, token)
					console.log(vinFix)
					if (vinFix['result'])
						alert('연동 차량 유지 성공했습니다')
					else
						alert('연동 차량 유지 실패했습니다')
				})

			}
			else if (id === "ModalUserName") {

				$('#ModalUserName #userNameChangeBtn').on('click', function () {
					const nameData = nameChange(token, $("#userNameInput").val())
					if (nameData['result'])
						alert('계종 변경 성공했습니다')
					else
						alert('계종 변경 실패했습니다')
				})
				$('#ModalUserName #nameChangeClose').on('click', function () {
					popupClose("ModalUserName")
				})
			}
			else if (id === "ModalId") {
				$('#ModalId #idChangeBtn').on('click', function () {
					const idData = idChange(token, $("#idInput").val())
					if (idData['result'])
						alert('아이디 변경 성공했습니다')
					else
						alert('아이디 변경 실패했습니다')
				})

			}
			else if (id === "ModalPw") {
				$("#pwChangeBtn").on('click', function () {
					var pwOld = $("#pwOldInput").val().trim().toLowerCase();
					var pwNew = $("#pwNewInput").val().trim().toLowerCase();
					var pwCheck = $("#pwNewInputCheck").val().trim().toLowerCase();
					if (!pwOld || !pwNew || !pwCheck) {
						alert("모든 항목을 입력해주세요")
					} else {
						if (pwNew.length < 4) {
							$("#pwStrengthCheck").show()
						} else {
							$("#pwStrengthCheck").hide()
							if (pwNew !== pwCheck) {
								$("#pw-match-check").show()

							} else {
								$("#pw-match-check").hide()
								const pwData = pwChange(token, pwOld, pwNew);
								if (pwData['result']){ 
									alert('비밀 번호 변경 성공했습니다')
								}
								else{
									alert('비밀번호 변경 실패했습니다')
									return
								  }
								popupClose('ModalPw')
								return
							}
						}
					}

				})
			}
			else if (id === "Modal2") {
				$('#Modal2 #vehicleReg').on('click', function () {
					const regData = vehicleRegister(token, $("#deviceSnInput").text(), $("#vehiclePlateNumInput").val(), $("#pclInput").val(), $("#v2xKeyInput").val());
					if (regData['result']) {
						alert('등록 성공했습니다')
						renderDeviceList()
						renderVehicleList()
					}
					else
						alert('등록 실패했습니다')
					popupClose('Modal2')
				})
			}

		}

		function popupClose(id) {
			$('#' + id).fadeOut(300);
			$('body').removeClass('popup-on');
			$('#vinMismatch').val('');
			if (id === "ModalPw") {
				$("#pw-match-check").hide()
				$("#pwStrengthCheck").hide()
				$("#pwOldInput").val("")
				$("#pwNewInput").val("")
				$("#pwNewInputCheck").val("")
			}

		}


	</script>

</body>

</html>